pipeline {
    agent any{
         environment {
     DOCKERHUB_CREDENTIALS = credentials('prathibhagond')
     registry = "prathibhagond/LMS-BE"
        registryCredential = 'dockeruserprathibha'
        dockerImage = ''
    }
stage('creating database container') {
             steps {
                 sh 'docker container rm --force lmsdb'
                 sh 'docker run -d -p 3306:3306 --network lms-network -e  MYSQL_PASSWORD=p@55word --name lmsdb mysql'
            }
        }
         stage('Running the docker container') {
            steps {
                  sh 'docker container rm --force backend'
                  sh 'docker run -d -p 8080:8080 --network lms-network -e DATABASE_URL=mysql://root:p@55word@lmsdb:3306/mysql --name backend -e PORT=8080 -e MODE=local  prathibhagond/backend-lms'
            }
        }
}
}
